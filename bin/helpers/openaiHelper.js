import { OpenAI } from "openai";

/**
 * Create subtitles from a file stream using OpenAI API.
 *
 * @param {Object} options - An object containing file stream, API key, and mode
 * @return {Promise<{import("openai/resources/audio/transcriptions.js").Transcription[]}>} The transcription generated by the OpenAI API
 */
export async function createSubtitles({ fileStream, key, mode }) {
  const openai = new OpenAI({
    apiKey: key,
  });

  const transcription = await openai.audio.transcriptions.create({
    file: fileStream,
    model: "whisper-1",
    response_format: "verbose_json",
    timestamp_granularities: mode,
  });

  return transcription;
}
